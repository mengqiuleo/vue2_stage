{"version":3,"file":"vue.js","sources":["../src/compiler/parse.js","../src/compiler/index.js","../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/observe/watcher.js","../src/state.js","../src/vdom/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/index.js"],"sourcesContent":["const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;  \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配标签开头 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的，第一个分组就是属性的key, value就是 分组3、分组4、分组5\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配开始标签结束的 >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g //匹配的是表达式的变量 {{ name }} 这里会匹配出name\r\n\r\n// 将模板解析成ast语法树\r\n//思路：匹配一部分，然后删掉这部分，直到删除完毕，使用while函数\r\nexport function parseHTML(html) { //html最开始肯定是一个<\r\n  const ELEMENT_TYPE = 1; //标签类型\r\n  const TEXT_TYPE = 3; //文本类型\r\n  const stack = [];//构建父子关系\r\n  let currentParent; //指向的是栈中的最后一个：当前的父亲\r\n  let root;\r\n\r\n  function createASTElement(tag, attrs){\r\n    return {\r\n      tag,\r\n      type: ELEMENT_TYPE,\r\n      children: [],\r\n      attrs,\r\n      parent: null\r\n    }\r\n  }\r\n\r\n  //下面三个函数用来处理匹配到的标签和属性\r\n  function start(tag, attrs){ //遇到开始标签：创建一个元素\r\n    let node = createASTElement(tag, attrs)\r\n    if(!root){ //看一下是否为空树\r\n      root = node; //如果为空则当前是数的根节点\r\n    }\r\n    if(currentParent){\r\n      node.parent = currentParent\r\n      currentParent.children.push(node)\r\n    }\r\n    stack.push(node);\r\n    currentParent = node; //currentParent是最近的父节点\r\n  }\r\n  function end(tag){\r\n    let node = stack.pop();\r\n    currentParent = stack[stack.length - 1]\r\n  }\r\n  function chars(text) {\r\n    text = text.replace(/\\s/g,'') //替换掉空文本\r\n    text && currentParent.children.push({\r\n      type: TEXT_TYPE,\r\n      text,\r\n      parent: currentParent\r\n    })\r\n  }\r\n\r\n\r\n  function advance(n){\r\n    html = html.substring(n);\r\n  }\r\n\r\n  //该函数用来匹配开始标签\r\n  function parseStartTag(){\r\n    const start = html.match(startTagOpen);\r\n    // console.log(start); start是一个数组，打印查看\r\n    if(start) { //如果是开始标签\r\n      const match = {\r\n        tagName: start[1], //标签名(其实对于start数组我们可以将值打印出来看)\r\n        attrs: [] //标签属性\r\n      }\r\n      advance(start[0].length); //前进：将已经匹配了的删除\r\n      // console.log(match, html);\r\n\r\n      //走到这一步：已经将开始标签匹配完了：就是将 <div 匹配到，接下来该匹配开始标签里面的属性了\r\n\r\n      // 如果不是开始标签的结束，说明是属性：就一直匹配下去（一直在匹配属性）\r\n      let attr; //一个变量：存储属性\r\n      let end; //一个变量：存储开始标签的结束> eg: <div id='app'> 这里匹配的是右边的 >\r\n      while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\r\n        advance(attr[0].length) //删掉属性\r\n        match.attrs.push({name: attr[1], value: attr[3] || attr[4] || attr[5]})\r\n      }\r\n      //删掉开始标签的右>\r\n      if(end){\r\n        advance(end[0].length)\r\n      }\r\n      return match;\r\n    }\r\n    \r\n    return false; //不是开始标签\r\n  }\r\n\r\n  //一直匹配直到html解析完\r\n  while(html){\r\n    // 如果textEnd 为0， 说明是一个开始标签或者 是结束标签(如果是结束标签的话，那么就说明结束标签前面的字符全部被匹配完毕，并且也被删除了，因为我们的匹配会将匹配完的地方逐渐删除掉)\r\n    // 如果textEnd 大于0，说明是这样的： hello</div> , 此时还在匹配文本串\r\n    let textEnd = html.indexOf('<'); \r\n\r\n    if(textEnd == 0){ //如果是开始标签\r\n      const startTagMatch = parseStartTag(); //开始标签的匹配结果\r\n      if(startTagMatch){\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        // 在这里，开始标签已经截取结束了。那么就continue，跳出循环然后继续向后匹配\r\n        continue;\r\n      }\r\n\r\n      // 如果不是开始标签，那就是匹配开始标签的结束标签（因为上面直接continue了，所以开始和结束只会匹配一个）\r\n      let endTagMatch = html.match(endTag)\r\n      if(endTagMatch){\r\n        advance(endTagMatch[0].length)\r\n        end(endTagMatch[1]) \r\n        continue;\r\n      }\r\n    }\r\n\r\n    if(textEnd > 0){ //如果是文本内容\r\n      let text = html.substring(0,textEnd)\r\n      if(text){\r\n        chars(text)\r\n        advance(text.length)//移出解析到的文本\r\n      }\r\n    }\r\n  }\r\n  // console.log(\"解析到的ast树：\", root)\r\n  return root;\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 19:50:35\r\n * @LastEditTime: 2022-10-05 10:10:28\r\n */\r\n\r\nimport { parseHTML } from \"./parse\";\r\n\r\n// genProps函数用来解析属性\r\nfunction genProps(attrs){\r\n  let str = '' // {name. value} //str返回所有属性拼接后的字符串\r\n  for(let i=0; i<attrs.length; i++){\r\n    let attr = attrs[i];\r\n    if(attr.name === 'style'){ //style属性特殊处理，因为要对style属性加一个{}，style标签返回的是一个对象\r\n      let obj = {};\r\n      \r\n      // color:red;background:red => {color:'red'}\r\n      // 每一项用;分割，然后每一项item用：分割出属性和属性名\r\n      //用;分割出来的是一个属性名加属性值\r\n      attr.value.split(';').forEach(item => {\r\n        let [key, value] = item.split(':')\r\n        obj[key] = value;\r\n      });\r\n      attr.value = obj;\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},` //这里是加上每个属性\r\n  }\r\n  return `{${str.slice(0,-1)}}`; //因为每个属性直接都是用 , 隔开，所以最后一个属性多了一个逗号 所以进行截取\r\n  //最终返回的结果样子：{id:\"app\",style:{\"color\":\"aqua\",\" background\":\" yellow\"}}\r\n}\r\n\r\n\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g //匹配的是表达式的变量 {{ name }} 这里会匹配出name\r\nfunction gen(node){\r\n  if(node.type === 1){ //是节点\r\n    return codegen(node); //继续递归遍历\r\n  } else { //是文本\r\n    let text = node.text;\r\n    if(!defaultTagRE.test(text)){ //如果没有匹配到双括号的变量，说明是一个纯文本，直接使用JSON.stringify\r\n      return `_v(${JSON.stringify(text)})`\r\n    } else { //说明出现了变量：比如是{{name}}\r\n      //eg: _v(_s(name) + 'hello' + _s(name))\r\n      let tokens = []; //最后匹配到的多个变量\r\n      let match; //每次匹配到的变量\r\n      defaultTagRE.lastIndex = 0; //将lastIndex属性置为0：因为exec匹配只会每次重头开始匹配，我们需要让它继续上一次的位置进行匹配\r\n      let lastIndex = 0;\r\n      while(match = defaultTagRE.exec(text)){ //循环匹配，因为有多个变量\r\n        let index = match.index;\r\n        if(index > lastIndex){ // 这里是用来匹配 {{name}} hello {{age}} 中的hello\r\n          tokens.push(JSON.stringify(text.slice(lastIndex,index))) //自己的普通字符串直接stringify就行\r\n        }\r\n        tokens.push(`_s(${match[1].trim()})`) //对于变量，要用_s包裹\r\n        lastIndex = index + match[0].length //lastIndex每次都要向前进一步：超过当前变量的长度\r\n      }\r\n      if(lastIndex < text.length){ //这里是用来匹配 {{name}} hello {{age}} hello 中的第二个hello\r\n        tokens.push(JSON.stringify(text.slice(lastIndex))) //最后出现的普通字符串也是只用stringify就行\r\n      }\r\n      return `_v(${tokens.join('+')})`\r\n    }\r\n  }\r\n}\r\n\r\n//genChildren函数处理孩子\r\nfunction genChildren(children){\r\n  return children.map(child => gen(child))\r\n}\r\n\r\n\r\n// codegen函数用来将ast生成render函数（render函数其实就是一个字符串，用with调用来使这个字符串变成函数，通过调用可以生成虚拟DOM）\r\nfunction codegen(ast){\r\n  let children = genChildren(ast.children);\r\n  let code = (`_c('${ ast.tag }', ${ ast.attrs.length > 0 ? genProps(ast.attrs) : 'null' }${ ast.children.length ? `,${ children }` : '' })`)\r\n    /**\r\n     * 上面分别是自己的标签，属性，孩子（属性和孩子之间的,放在了孩子那里再加）\r\n     */\r\n  return code\r\n}\r\n\r\n//对模板进行编译处理\r\nexport function compileToFunction(template) {\r\n  // 第一步：将template 转换为 ast语法树\r\n  let ast = parseHTML(template)\r\n  console.log('生成的ast树：',ast) //验证ast树\r\n\r\n  // 第二步：生成render方法（render方法执行后返回的结果就是 虚拟DOM）\r\n  /**我们最终要转换成的render函数\r\n    render(){\r\n      return _c('div',{style:{color:'red'}},_v('hello'+_s(name)),_c('span',undefined,''))\r\n    }\r\n    _c：创建元素  _v：创建文本  _s: JSON.stringify\r\n   */\r\n  let code = codegen(ast); //现在已经生成了render函数的字符串，接下来我们需要让字符串可以运行\r\n  code = `with(this){return ${code}}` //包了一层with，那么code中的代码都会去this上取值，那么一会儿我们准备执行的时候，可以绑定个this，这样我们就可以随意的指定要执行的对象了\r\n  //因为我们的render函数上的变量比如name,age都在vm上，所以一会儿我们执行render函数的时候可以设置.call(vm)，这样就拿到了vm身上的变量值\r\n\r\n  let render = new Function(code);//生成render函数\r\n  /**\r\n   * with是干嘛的？\r\n   * let obj = {a:1}\r\n   * with(obj){\r\n   *  console.log(a)\r\n   * }\r\n   * 对于上面这段代码：在{}里面的代码都会去obj上取值，也就是说：with可以限定取值的对象是谁\r\n   */\r\n\r\n\r\n\r\n  return render;\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 17:45:37\r\n * @LastEditTime: 2022-10-05 23:23:41\r\n */\r\n// 重写数组中的部分方法\r\n\r\nlet oldArrayProto = Array.prototype; //获取数组的原型\r\n\r\nexport let newArrayProto = Object.create(oldArrayProto);\r\n\r\nlet methods = [ //找到所有变异方法\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'reverse',\r\n  'sort',\r\n  'splice'\r\n] //concat slice 都不会改变原数组\r\n\r\nmethods.forEach(method => {\r\n  //arr.push(1,2,3)\r\n  newArrayProto[method] = function(...args){ //这里重写了数组的方法\r\n    const result = oldArrayProto[method].call(this,...args) //内部调用原来的方法\r\n    \r\n    //我们需要对新增的数据再次进行劫持\r\n    let inserted; //该变量存放新增的数据值\r\n\r\n    // 根据newArrayProto的被引用位置：我们可以得知，这里的this应该是 class Observe的实例对象\r\n    let ob = this.__ob__;//这里的ob就是Observe实例，并且它身上有对数组进行观测的observeArray方法\r\n\r\n    switch(method){\r\n      case 'push':\r\n      case 'unshift': //arr.unshift(1,2,3)\r\n        inserted = args;\r\n        break;\r\n      case 'splice': //arr.splice(0,1,{a:1})\r\n        inserted = args.slice(2);\r\n      default:\r\n        break;\r\n    }\r\n    console.log('新增的数组的数据：',inserted);\r\n    if(inserted){ //对新增的内容再次进行观测\r\n      //既然要对新增的数据进行观测：那么还是要调用最初监测数组的方法来对新增数据进行观测\r\n      //那个新增的方法在Observe实例的observeArray函数，所以我们要拿到Observe实例\r\n      //怎么拿？ 在Observe类中，我们已经绑定了this到__ob__属性上，并且在这里：根据这里被调用的位置可知，这里的this就是class Observe的实例对象\r\n      //所以，我们直接拿一个变量来承接Observe实例 -> let ob = this.__ob__;(在上面已经声明过了)\r\n    \r\n      //下面就是对新增的数据再次进行观测\r\n      ob.observeArray(inserted);\r\n    }\r\n\r\n    ob.dep.notify() //数组变化，通知对应的watcher进行更新\r\n    return result\r\n  }\r\n})","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-05 21:24:29\r\n * @LastEditTime: 2022-10-06 18:31:50\r\n */\r\n\r\nlet id = 0;\r\nclass Dep {\r\n  constructor(){ \r\n    this.id = id++;\r\n    this.subs = []; //这里存放这当前属性对应的watcher有哪些\r\n  }\r\n  depend(){ //我们希望dep和watcher实现双向收集\r\n    Dep.target.addDep(this); //Dep.target指的是当前的watcher，然后调用watcher的addDep方法\r\n  }\r\n  addSub(watcher){\r\n    this.subs.push(watcher); //当前dep收集当前watcher\r\n  }\r\n  notify(){ //通知该属性的所有watcher都要进行更新\r\n    this.subs.forEach(watcher => watcher.update());\r\n  }\r\n}\r\nDep.target = null; //暴露一个属性用来连接dep和watcher\r\n\r\nlet stack = [];\r\n// 存储计算属性的watcher\r\nexport function pushTarget(watcher){\r\n  stack.push(watcher);\r\n  Dep.target = watcher;\r\n}\r\nexport function popTarget(){\r\n  stack.pop();\r\n  Dep.target = stack[stack.length-1];\r\n}\r\n\r\nexport default Dep;","import { newArrayProto } from \"./array\"\r\nimport Dep from \"./dep\"\r\n\r\n/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 15:33:12\r\n * @LastEditTime: 2022-10-05 23:29:30\r\n */\r\nclass Observer{\r\n  constructor(data){\r\n    //给数组本身增加dep,如果数组新增了某一项，就要触发dep更新\r\n    //给对象增加dep，如果后序用户增加了属性，也要触发dep更新\r\n\r\n    //要给每个对象都增加收集功能\r\n    this.dep = new Dep()\r\n\r\n\r\n\r\n    //Object.defineProperty只能劫持已经存在的属性（vue里面会为此单独写一些api $set $delete）\r\n    \r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false //将__ob__变成不可枚举型（循环时无法获取到）\r\n    })\r\n    //上面就是一个定义属性，不必要再写 data.__ob__ = this; 这句代码\r\n\r\n    //data.__ob__ = this;//将this实例绑定到__ob__属性上\r\n    //不仅是将this绑定到__ob__属性上，方便再次对新增的数组内容进行观测（具体观测在array.js文件中）\r\n    //而且也给数据加了一个标识：因为在最初的入口中，我们需要判断当前数据是否被劫持过了，如果已经被劫持了，那就直接返回：\r\n    //如果一个对象被劫持过了，那就不需要再被劫持了（要判断一个对象是否被劫持过，可以增添一个实例，用实例来判断是否被劫持过）\r\n    //既然是用一个实例来判断当前数据是否被劫持过了：\r\n    //那么这个 __ob__ 属性就是一个标识，如果数据已经被劫持了，那么它的实例身上一定有一个__ob__的标识\r\n    //具体代码在 observe(data)函数中体现\r\n\r\n    // 增加这个__ob__属性，其实会有一点问题 -> 会产生死循环\r\n    // 因为给当前类的实例增加了这个属性的值是this代指当前对象\r\n    //当我们对进行属性劫持并且遍历各个属性值时，走到defineReactive函数，进行set设置时，又会走observe函数，然后又会进到类的实例中，\r\n    // 在类的实例中，又会对对象进行劫持，然后就会产生死循环\r\n    //如何解决？ 将这个属性变成不可枚举型的，这部分操作在上面\r\n\r\n\r\n    if(Array.isArray(data)){\r\n      //这里我们可以重写数组中的方法，7个变异方法是可以修改数组本身的\r\n      data.__proto__ = newArrayProto //保留数组原有的特性，并且重写部分方法\r\n      this.observeArray(data) //如果数组中放的是对象，可以监控到对象的变化\r\n    }else{\r\n      this.walk(data)\r\n    }\r\n    \r\n  }\r\n\r\n  walk(data){ //循环对象，对象属性依次劫持\r\n    // 重新定义属性\r\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]))\r\n  }\r\n\r\n  observeArray(data){\r\n    // 对数组中的是对象的某一项进行观测\r\n    data.forEach(item => observe(item))\r\n  }\r\n}\r\n\r\nfunction dependArray(value){\r\n  for(let i=0; i < value.length; i++){\r\n    let current = value[i];\r\n    current.__ob__ && current.__ob__.dep.depend();\r\n    if(Array.isArray(current)){\r\n      dependArray(current)\r\n    }\r\n  }\r\n}\r\n\r\n// 数据劫持\r\n// 执行get时会进行dep和watcher的收集，在执行set时，让dep更新\r\nexport function defineReactive(target, key, value){\r\n  let childOb = observe(value); //递归进行：如果属性是对象那就继续进行代理\r\n  //childOb中就有一个dep属性 用来收集依赖\r\n  let dep = new Dep(); //每一个属性都增加一个dep \r\n  Object.defineProperty(target, key, {\r\n    get(){ //取值的时候 执行get\r\n      if(Dep.target){\r\n        dep.depend(); //让这个属性的收集器记住当前的watcher\r\n        if(childOb){\r\n          childOb.dep.depend();//让数组和对象本身也实现依赖收集\r\n\r\n          if(Array.isArray(value)){\r\n            dependArray(value)\r\n          }\r\n        }\r\n      }\r\n      return value\r\n    },\r\n    set(newValue){ //修改的时候，会执行set\r\n      if(newValue){\r\n        if(newValue === value) return\r\n        observe(value); //递归进行：如果设置的值还是对象那就继续进行代理\r\n        value = newValue\r\n        dep.notify(); //更新dep,通知watcher进行更新\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data) {\r\n  //对对象进行劫持\r\n  if(typeof data !== 'object' || data == null){\r\n    return; //只对对象进行劫持\r\n  }\r\n\r\n  if(data.__ob__ instanceof Observer){ //说明这个对象被代理过了\r\n    return data.__ob__;\r\n  }\r\n  //如果一个对象被劫持过了，那就不需要再被劫持了（要判断一个对象是否被劫持过，可以增添一个实例，用实例来判断是否被劫持过）\r\n\r\n  return new Observer(data); //我们返回的是一个被劫持过的对象\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-05 21:09:03\r\n * @LastEditTime: 2022-10-06 18:55:27\r\n */\r\n/**\r\n * 观察者模式\r\n * 我们可以给模板中的属性 增加一个收集器dep\r\n * 页面渲染的时候 我们将渲染逻辑封装到watcher中 vm._update(vm.render())\r\n * 让dep记住这个watcher即可，稍后属性变化了可以找到对应的dep中存放的watcher进行重新渲染\r\n * \r\n * 每个属性有一个dep(属性就是被观察者)，watcher就是观察者（属性变化了会通知观察者来更新）\r\n */\r\n\r\nimport Dep, { popTarget, pushTarget } from \"./dep\";\r\n\r\n/**\r\n * 每一个组件都有一个watcher，watcher中放了一个组件中的很多属性dep，并且我们给每个组件赋一个id标识\r\n * 每一个属性有一个dep属性，里面存放了这个属性的watcher，可能一个属性的dep中存放了很多个watcher，因为这个属性在很多地方都用到了\r\n * 当这个组件的属性没有被渲染时，dep和watcher是不会被收集的\r\n */\r\nlet id = 0;\r\n\r\nclass Watcher {\r\n  constructor(vm, fn, options){\r\n    this.id = id++;\r\n    this.renderWatcher = options; //true表示是一个渲染watcher（因为计算属性也有watcher，那是一个计算watcher）\r\n    this.getter = fn; //getter意味着调用这个函数可以发生取值操作\r\n    this.deps = []; //存放该组件watcher的dep数组\r\n    this.depsId = new Set(); //对dep进行去重，只收集一次某个dep\r\n    this.lazy = options.lazy; //针对计算属性\r\n    this.dirty = this.dirty; //针对计算属性，看是否是脏值\r\n    this.lazy ? undefined : this.get(); //初次渲染先调用一次： 使 vm._update(vm._render()) 执行\r\n    //但是首先要判断是否是计算属性，如果不是，就是初次渲染先调用一次\r\n  }\r\n  addDep(dep){ //让当前watcher收集它的dep\r\n    let id = dep.id; //拿到该dep的id\r\n    if(!this.depsId.has(id)){ //如果一个属性在视图上进行多次渲染，但是只需要收集一次\r\n      this.deps.push(dep);\r\n      this.depsId.add(id);\r\n      dep.addSub(this); //让dep记住watcher\r\n    }\r\n  }\r\n  get(){\r\n    pushTarget(this); //在执行watcher之前，将当前dep增加一个当前watcher，这样我们就将当前dep和watcher连接起来了\r\n    //当我们创建渲染watcher的时候，我们会把当前的渲染watcher放到Dep.target上\r\n    this.getter(); //会去vm上取值，此时就调用了vm._update(vm._render())，当调用该render函数时，我们就会走到数据劫持的get()上\r\n    popTarget(); //当当前组件渲染完毕后，我们就将target清空\r\n  }\r\n  update(){ //我们需要实现异步更新：即多次修改值只会最终执行一次视图更新\r\n    //实现方案：使用异步更新 -> 事件环\r\n    // this.get(); //重新渲染\r\n    queueWatcher(this); //把当前的watcher暂存起来\r\n  }\r\n  run(){\r\n    // console.log('更新视图只执行一次')\r\n    this.get(); //重新渲染\r\n  }\r\n}\r\n\r\nlet queue = [];\r\nlet has = {}; //实现去重\r\nlet pending = false; //防抖：多次修改值，只进行一轮刷新\r\nfunction flushSchedulerQueue(){ //执行所有要进行的更新视图操作\r\n  let flushQueue = queue.slice(0);\r\n  queue = [];\r\n  has = {};\r\n  pending = false\r\n  flushQueue.forEach(q => q.run())\r\n}\r\n\r\nfunction queueWatcher(watcher){\r\n  const id = watcher.id;\r\n  if(!has[id]){\r\n    queue.push(watcher);\r\n    has[id] = true;\r\n    //不管我们的update执行多少次，但是最终只执行一轮刷新操作\r\n    if(!pending){\r\n      //setTimeout(flushSchedulerQueue,0);\r\n      //原来我们是使用setTimeout实现异步更新，但是其实底层我们可以也可以使用promise来实现异步更新\r\n      //vue为了统一，实现了自己的异步更新方法：nextTick\r\n      nextTick(flushSchedulerQueue);\r\n      pending = true;\r\n    }\r\n  }\r\n}\r\n\r\nlet callbacks = [];\r\nlet waiting = false;\r\nfunction flushCallbacks(){\r\n  waiting = false;\r\n  let cbs = callbacks.slice(0);\r\n  callbacks = []\r\n  cbs.forEach(cb => cb());\r\n}\r\n//nextTick 没有直接使用某个api 而是采用优雅降级的方式\r\n//内部先采用的是promise（ie不兼容） MutationObserver(h5的api) 可以考虑ie专享的 setImmediate setTimeout\r\n// let timerFunc;\r\n// if (Promise) { // then方法是异步的\r\n//   timerFunc = () => {\r\n//       Promise.resolve().then(flushCallbacks)\r\n//   }\r\n// }else if (MutationObserver) { // MutationObserver 也是一个异步方法\r\n//   let observe = new MutationObserver(flushCallbacks); // H5的api\r\n//   let textNode = document.createTextNode(1);\r\n//   observe.observe(textNode, {\r\n//       characterData: true\r\n//   });\r\n//   timerFunc = () => {\r\n//       textNode.textContent = 2;\r\n//   }\r\n// }else if (setImmediate) {\r\n//   timerFunc = () => {\r\n//       setImmediate(flushCallbacks)\r\n//   }\r\n// }else{\r\n//   timerFunc = () => {\r\n//       setTimeout(flushCallbacks, 0);\r\n//   }\r\n// }\r\n\r\nexport function nextTick(cb){ //会先调用户写的nextTick还是内部的nextTick？？ 不一定，谁放在前面就先执行谁\r\n  callbacks.push(cb);\r\n  if(!waiting){\r\n    // timerFunc();\r\n    Promise.resolve().then(flushCallbacks)\r\n    waiting = true;\r\n  }\r\n}\r\n\r\nexport default Watcher","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 15:28:08\r\n * @LastEditTime: 2022-10-06 19:17:22\r\n */\r\nimport { observe } from './observe/index'\r\nimport Watcher, { nextTick } from './observe/watcher';\r\n\r\nexport function initState(vm){\r\n  const opts = vm.$options; //获取所有选项\r\n  if(opts.data) {\r\n    initData(vm);\r\n  }\r\n  if(opts.computed){\r\n    initComputed(vm);\r\n  }\r\n}\r\n\r\n//将 vm._data 用 vm 来代理\r\nfunction proxy(vm, target, key){\r\n  Object.defineProperty(vm, key, {\r\n    get(){\r\n      return vm[target][key];\r\n    },\r\n    set(newValue){\r\n      vm[target][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\nfunction initData(vm){\r\n  let data = vm.$options.data; //data可能是函数或者对象\r\n  // 这里我们只是拿到了用户的数据，但是得把数据绑定到vm上，如何绑定呢？用 _data\r\n  data = typeof data === 'function' ? data.call(vm) : data; //data是用户返回的对象\r\n\r\n  vm._data = data //我将返回的对象放到了_data上\r\n  //现在已经成功绑定了，但是访问不太方便：vm._data.name\r\n  //怎么变方便呢？ -> 将 vm._data 用 vm 来代理\r\n\r\n  // 接下来是对数据进行劫持 vue2里采用了一个api defineProperty\r\n  observe(data)\r\n\r\n  //将 vm._data 用 vm 来代理\r\n  for(let key in data){\r\n    proxy(vm, '_data', key);\r\n  }\r\n}\r\n\r\n/**\r\n * 计算属性 依赖的值发生变化才会重新执行用户的方法，计算属性中要维护一个dirty属性，默认计算属性不会立即执行\r\n * 计算属性就是一个defineProperty\r\n * 计算属性也是一个watcher，默认渲染会创造一个渲染watcher\r\n */\r\nfunction initComputed(vm){\r\n  const computed = vm.$options.computed;\r\n  const watchers = vm._computedWatchers = {} //将计算属性watcher保存到vm上\r\n  // console.log(computed)\r\n  for(let key in computed){\r\n    let userDef = computed[key];\r\n    \r\n    //我们需要监控 计算属性中get的变化\r\n    let fn = typeof userDef === 'function' ? userDef : userDef.get;\r\n\r\n    //如果直接 new Watcher 默认就会执行fn, 将属性和watcher对应起来\r\n    watchers[key] = new Watcher(vm, fn, {lazy:true}) //lazy:true: 如果不取值，就不用执行watcher\r\n\r\n\r\n\r\n    //将getter和setter进行数据劫持\r\n    defineComputed(vm, key, userDef);\r\n\r\n  }\r\n}\r\nfunction defineComputed(target, ket, userDef){\r\n  //拿到对应的getter和setter\r\n  const getter = typeof userDef === 'function' ? userDef : userDef.get;\r\n  const setter = userDef.set || (() => {});\r\n\r\n  //可以通过实例拿到setter和getter属性\r\n  Object.defineProperty(target, key, {\r\n    get:createComputedGetter(getter, key),\r\n    set:setter\r\n  })\r\n}\r\nfunction createComputedGetter(key){\r\n  //我们需要监测是否要执行这个getter\r\n  return function(){\r\n    const watcher = this._computedWatchers[key]//获取到对应属性的watcher\r\n  }\r\n}\r\n\r\nexport function initStateMixin(Vue){\r\n  Vue.prototype.$nextTick = nextTick\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-05 10:46:26\r\n * @LastEditTime: 2022-10-06 16:07:43\r\n */\r\n//_c() 创建文本\r\nexport function createTextVNode(vm,text){\r\n  return vnode(vm,undefined,undefined,undefined,undefined,text)\r\n}\r\n\r\n//_v() 创建节点\r\nexport function createElementVNode(vm, tag, data = {}, ...children){\r\n  if(data == null){\r\n    data = {}\r\n  }\r\n  let key = data.key;\r\n  if(key){ //上面我们已经取出了key，所以可以删掉key\r\n    delete data.key\r\n  }\r\n  return vnode(vm,tag,key,data,children)\r\n}\r\n\r\n// 虚拟dom比ast功能更强大，可以增加一些自定义属性\r\nfunction vnode(vm,tag,key,data,children,text){\r\n  return {\r\n    vm,\r\n    tag,\r\n    key,\r\n    data,\r\n    children,\r\n    text\r\n  }\r\n}\r\n\r\nexport function isSameVNode(vnode1, vnode2){\r\n  return vnode1.tag === vnode2.tag && vnode1.key === vnode2.key\r\n}","import { isSameVNode } from \"./index\";\r\n\r\n/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-06 14:52:15\r\n * @LastEditTime: 2022-10-06 18:14:36\r\n */\r\nexport function createElm(vnode){\r\n  let { tag, data, children, text } = vnode;\r\n  if(typeof tag === 'string'){ //如果是标签\r\n    vnode.el = document.createElement(tag); //??? 将真实节点和虚拟节点对应起来\r\n    patchProps(vnode.el, {}, data) //绑定属性\r\n    children.forEach(child => {\r\n      vnode.el.appendChild(createElm(child))\r\n    });\r\n  } else{\r\n    vnode.el = document.createTextNode(text)\r\n  }\r\n  return vnode.el\r\n}\r\n\r\n//对比新旧节点的属性\r\nexport function patchProps(el, oldProps = {}, props = {}){ //更新属性\r\n  //老的属性中有，新的没有，要删除老的\r\n  let oldStyles = oldProps.style || {}\r\n  let newStyles = props.style || {} //老的样式中有，新的没有，则删除\r\n  for(let key in oldStyles){\r\n    if(!newStyles[key]){\r\n      el.style[key] = ''\r\n    }\r\n  }\r\n  for(let key in oldProps){ //老的属性中有，新的没有，删除\r\n    if(!props[key]){\r\n      el.removeAttribute(key);\r\n    }\r\n  }\r\n  \r\n  for(let key in props){ //用新的覆盖掉老的\r\n    if(key === 'style'){\r\n      for(let styleName in props.style){\r\n        el.style[styleName] = props.style[styleName]\r\n      }\r\n    }else{\r\n      el.setAttribute(key, props[key]);\r\n    }\r\n  }\r\n}\r\n\r\n// patch(el,vnode)\r\nexport function patch(oldVNode, vnode){\r\n  const isRealElement = oldVNode.nodeType;\r\n  if(isRealElement){  //初渲染流程\r\n    const elm = oldVNode; //获取真实元素\r\n    const parentElm = elm.parentNode; //拿到父元素\r\n    let newElm = createElm(vnode) //此时元素已经创建好了，属性也绑定了\r\n    parentElm.insertBefore(newElm, elm.nextSibling) //插入新节点\r\n    parentElm.removeChild(elm) //删除老节点\r\n\r\n    return newElm\r\n  }else{\r\n    //diff算法\r\n    /**\r\n     * 1.两个节点不是同一个节点，直接删除老的换上新的（没有比对了）\r\n     * 2.两个节点是同一个节点（判断节点的tag和节点的key）比较两个节点的属性是否有差异（复用老的节点，将差异的属性更新）\r\n     * 3.节点比较完毕后就需要比较两个节点的儿子\r\n     */\r\n\r\n    return patchVNode(oldVNode, vnode)\r\n    \r\n  }\r\n}\r\n\r\nfunction patchVNode(oldVNode, vnode){\r\n  //两个节点不是同一个节点，直接删除老的换上新的（没有比对了）\r\n  if(!isSameVNode(oldVNode, vnode)){ //tag===tag && key===key\r\n    //用老节点的父亲 进行替换\r\n    let el = createElm(vnode);\r\n    oldVNode.el.parentNode.replaceChild(el, oldVNode.el)\r\n    return el;\r\n  }\r\n\r\n  //上面的情况是节点完全不一样，现在是节点一样，先特殊处理文本\r\n  let el = vnode.el = oldVNode.el; //复用老节点的元素\r\n  if(!oldVNode.tag){ //是文本\r\n    if(oldVNode.text !== vnode.text){\r\n      el.textContent = vnode.text; //用新的文本覆盖掉老文本\r\n    }\r\n  }\r\n\r\n  //是标签的情况, 我们需要对比标签的属性\r\n  patchProps(el, oldVNode.data, vnode.data)\r\n\r\n  //开始比较儿子节点\r\n  let oldChildren = oldVNode.children || [];\r\n  let newChildren = vnode.children || [];\r\n  if(oldChildren.length > 0 && newChildren.length > 0){\r\n    //完整的diff算法，需要比较两个人的儿子\r\n    updateChildren(el, oldChildren, newChildren)\r\n  }else if(newChildren.length > 0){ //没有老的，只有新的\r\n    mountChildren(el, newChildren) //挂载新的儿子\r\n  }else if(oldChildren.length > 0){ //新的没有\r\n    el.innerHTML = ''\r\n  }\r\n\r\n  return el;\r\n}\r\n\r\nfunction mountChildren(el, newChildren){\r\n  for(let i=0; i<newChildren.length; i++){\r\n    let child = newChildren[i];\r\n    el.appendChild(createElm(child));\r\n  }\r\n}\r\n\r\nfunction updateChildren(el, oldChildren, newChildren){\r\n  //diff算法只会比较同级的节点\r\n  // vue2采用双指针的算法 ：头指针和尾指针\r\n  //头头，尾尾，头尾，尾头\r\n\r\n  let oldStartIndex = 0;\r\n  let oldStartVnode = oldChildren[0];\r\n  let oldEndIndex = oldChildren.length - 1;\r\n  let oldEndVnode = oldChildren[oldEndIndex];\r\n\r\n  let newStartIndex = 0;\r\n  let newStartVnode = newChildren[0];\r\n  let newEndIndex = newChildren.length - 1;\r\n  let newEndVnode = newChildren[newEndIndex];\r\n\r\n  //针对乱序比对 -> 制作一个映射表\r\n  function makeIndexByKey(children){\r\n    let map = {\r\n    \r\n    };\r\n    children.forEach((child,index) => {\r\n      map[child.key] = index;\r\n    })\r\n    return map;\r\n  }\r\n  let map = makeIndexByKey(oldChildren);\r\n\r\n  while(oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex){\r\n    //双方有一方头指针，大于尾指针则停止循环\r\n    if(!oldStartVnode){ //出现不存在节点的原因：使用乱序比对，我们将节点进行移动，当前位置赋为undefined，所以出现不存在的情况，如果出现这种情况，那就向前/后继续移动指针就好了\r\n      oldStartVnode = oldChildren[++oldStartIndex]\r\n    }else if(!oldEndVnode){\r\n      oldEndVnode = oldChildren[--oldEndIndex]\r\n    }\r\n    //#头比头\r\n    else if(isSameVNode(oldStartVnode, newStartVnode)){ //如果是同一个节点\r\n      patchVNode(oldStartVnode, newStartVnode); //先比较当前节点的属性和样式，并且递归比较子节点\r\n      oldStartVnode = oldChildren[++oldStartIndex];\r\n      newStartVnode = newChildren[++newStartIndex];\r\n    }\r\n    //#尾比尾\r\n    else if(isSameVNode(oldEndVnode,newEndVnode)){\r\n      patchVNode(oldEndVnode, newEndVnode);\r\n      oldEndVnode = oldChildren[--oldEndIndex];\r\n      newEndVnode = newChildren[--newEndIndex];\r\n    }\r\n    //#尾比头\r\n    else if(isSameVNode(oldEndVnode, newStartVnode)){\r\n      patchVNode(oldEndVnode, newStartVnode);\r\n      //insertBefore具备移动性，会将原来的元素移动走\r\n      el.insertBefore(oldEndVnode.el, oldStartVnode.el); //将老的尾移动到老的开头\r\n      oldEndVnode = oldChildren[--oldEndIndex]; //老的尾指针向前移动\r\n      newStartVnode = newChildren[++newStartIndex]; //新的头向后移动\r\n    }\r\n    //#头比尾(全部都是旧结点比新节点)\r\n    else if(isSameVNode(oldStartVnode, newEndVnode)){\r\n      patchVNode(oldStartVnode, newEndVnode);\r\n      el.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling); //将老的头移动到老的尾\r\n      oldStartVnode = oldChildren[++oldStartIndex];\r\n      newEndVnode = newChildren[--newEndIndex];\r\n    }\r\n    //#乱序比对\r\n    else {\r\n      // 根据老的列表做一个映射关系，用新的去找，找到则移动，找不到则添加，最后多余的删除\r\n      let moveIndex = map[newStartVnode.key];//如果拿到则说明是我要移动的索引(新旧节点都有，移动即可)\r\n      if(moveIndex !== undefined){\r\n        let moveVnode = oldChildren[moveIndex]; //找到对应的旧结点 -> 复用\r\n        el.insertBefore(moveVnode.el, oldStartVnode.el); //将要移动的节点插入到旧开始结点的前面！！！\r\n        oldChildren[moveIndex] = undefined; //表示这个节点已经被移动走了\r\n        patchVNode(moveVnode, newStartVnode); //对比属性和子节点\r\n      }else {//如果找不到要移动的节点，那就根据新开始节点创造出一个节点，然后插入到旧开始节点的前面\r\n        el.insertBefore(createElm(newStartVnode), oldStartVnode.el);\r\n      }\r\n      newStartVnode = newChildren[++newStartIndex]; //新开始节点向后移动\r\n    }\r\n    \r\n  }\r\n  if(newStartIndex <= newEndIndex){ //如果新dom的节点长度大于旧结点，那就将新节点的多余部分插入\r\n    for(let i=newStartIndex; i<= newEndIndex; i++){\r\n      let childEl = createElm(newChildren[i]);\r\n      //这里不仅要适用于头比头，也要适用于尾比尾\r\n      //头比头：在后面继续追加，尾比尾：在前面插入\r\n      let anchor = newChildren[newEndIndex+1] ? newChildren[newEndIndex+1].el : null; \r\n      //anchor是一个参照物：判断新节点的尾指针的下一个是否有值，如果有值，证明是尾比尾，是在前面插入，如果没有值，那证明是头比头，要在后面继续插入\r\n      el.insertBefore(childEl, anchor);\r\n      // el.appendChild(childEl);\r\n    }\r\n  }\r\n  if(oldStartIndex <= oldEndIndex){ //如果新dom的节点长度小于旧结点，那就将旧节点的多余部分删除\r\n    for(let i=oldStartIndex; i<= oldEndIndex; i++){\r\n      if(oldChildren[i]){ //这部分的逻辑也适用于乱序比对\r\n        let childEl = oldChildren[i].el;\r\n        el.removeChild(childEl);\r\n      }\r\n    }\r\n  }\r\n\r\n  console.log(oldStartVnode,newStartVnode)\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-05 10:12:49\r\n * @LastEditTime: 2022-10-06 14:54:12\r\n */\r\nimport Watcher from './observe/watcher';\r\nimport { createElementVNode, createTextVNode } from './vdom/index'\r\nimport { patch } from './vdom/patch.js'\r\n\r\n\r\n\r\nexport function initLifeCycle(Vue){\r\n  Vue.prototype._update = function(vnode){ //将vnode转换成真实dom\r\n    const vm = this;\r\n    const el = vm.$el;\r\n\r\n    //patch既有初始化的功能，又有更新的功能\r\n    vm.$el = patch(el,vnode); //将VNode虚拟节点挂载到el元素上\r\n\r\n  }\r\n\r\n  Vue.prototype._v = function () { // 创建文本\r\n    return createTextVNode(this,...arguments);\r\n  }\r\n  Vue.prototype._c = function () { // 创建元素\r\n    return createElementVNode(this,...arguments);\r\n  }\r\n  Vue.prototype._s = function (val) {\r\n    if(typeof val !== 'object') return val\r\n    return JSON.stringify(val);\r\n  }\r\n  Vue.prototype._render = function(){\r\n    const vm = this;\r\n    // call: 让with中的this指向vm\r\n    return vm.$options.render.call(vm); //执行render函数拿到虚拟节点\r\n  }\r\n}\r\n\r\n//组件的挂载\r\n//挂载可以执行render函数产生虚拟节点 虚拟DOM，根据虚拟DOM产生真实DOM，插入到el元素中 \r\nexport function mountComponent(vm,el){\r\n  vm.$el = el;\r\n\r\n  // 1.调用render方法产生虚拟节点 虚拟DOM\r\n  // vm._render()\r\n\r\n  // 2.根据虚拟DOM产生真实DOM\r\n  // vm._update(vm._render())\r\n\r\n  const updatedComponent = () => {\r\n    vm._update(vm._render())\r\n  }\r\n  \r\n  new Watcher(vm, updatedComponent,true) //true用于表示是一个渲染watcher\r\n\r\n  // 3.插入到el元素中\r\n}","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 15:16:44\r\n * @LastEditTime: 2022-10-05 10:40:37\r\n */\r\nimport { initState } from './state'\r\nimport { compileToFunction } from './compiler/index'\r\nimport { mountComponent } from './lifecycle'\r\n\r\nexport function initMixin(Vue) { //就是给Vue增加init方法的\r\n  Vue.prototype._init = function(options){ //用于初始化话操作\r\n    // vm.$options 就是获取用户的配置\r\n\r\n    const vm = this;\r\n    vm.$options = options; //将用户的选项挂载到实例上\r\n\r\n    //初始化状态：就是挂载属性，方法，计算属性...\r\n    initState(vm);\r\n\r\n    if(options.el){\r\n      vm.$mount(options.el); //实现数据的挂载\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function(el) {\r\n    const vm = this;\r\n    el = document.querySelector(el);\r\n    let ops = vm.$options;\r\n\r\n    //优先级：render > template > el\r\n    //如果没有render\r\n    if(!ops.render) { //先进行查找有没有render函数\r\n      let template; //没有render查看是否写了template，没有写template就用外部的template\r\n      if(!ops.template && el) { //没有写模板，但是写了 el\r\n        template = el.outerHTML;\r\n      }else { //如果有模板\r\n        if(el) {\r\n          template = ops.template;\r\n        }\r\n      }\r\n      //写了template，就用写了的template\r\n      if(template && el){\r\n        //这里需要对模板进行编译\r\n        const render = compileToFunction(template); //根据template生成一个render函数\r\n        ops.render = render; //挂载render属性\r\n      }\r\n    }\r\n\r\n    mountComponent(vm, el); //组件的挂载\r\n    //有render就直接获取，我们最终都是要拿到一个render函数\r\n    ops.render; //最终就可以获取render方法 -> 获取：vm.$options.render\r\n    // 后续每次数据更新可以只执行render函数无需调用ast转换的过程\r\n  }\r\n}\r\n\r\n","/*\r\n * @Author: Pan Jingyi\r\n * @Date: 2022-10-04 14:36:30\r\n * @LastEditTime: 2022-10-06 17:32:13\r\n */\r\nimport { compileToFunction } from './compiler/index';\r\nimport { initMixin } from './init'\r\nimport { initLifeCycle } from './lifecycle'\r\nimport { initStateMixin } from './state'\r\nimport { createElm, patch } from './vdom/patch';\r\n\r\n\r\n// 将所有方法都耦合在一起\r\nfunction Vue(options) { //options就是用户的选项\r\n  this._init(options)\r\n}\r\n\r\n\r\ninitMixin(Vue); //扩展了init方法\r\ninitLifeCycle(Vue); //vm_update vm._render\r\ninitStateMixin(Vue); //实现了nextTick $watcher\r\n\r\n// diff的测试代码\r\nlet render1 = compileToFunction(`<ul key='a' a='1' style='color:red'>\r\n  <li key='a'>a</li>\r\n  <li key='b'>b</li>\r\n  <li key='c'>c</li>\r\n</ul>`)\r\nlet vm1 = new Vue({data: { name: 'zf' }})\r\nlet prevVNode = render1.call(vm1)\r\n\r\nlet el = createElm(prevVNode)\r\ndocument.body.appendChild(el)\r\n\r\n\r\nlet render2 = compileToFunction(`<li key='a' a='1' style='color:red'>\r\n  <li key='d'>d</li>\r\n  <li key='a'>a</li>\r\n  <li key='b'>b</li>\r\n  <li key='c'>c</li>\r\n</li>`)\r\nlet vm2 = new Vue({data: { name: 'zf' }})\r\nlet nextVNode = render2.call(vm2)\r\n\r\nconsole.log(prevVNode, nextVNode)\r\n\r\nsetTimeout(() => {\r\n  patch(prevVNode, nextVNode)\r\n  // let newEl = createEle(nextVNode)\r\n  // el.parentNode.replaceChild(newEl, el)\r\n}, 1000);\r\n\r\nexport default Vue\r\n\r\n\r\n"],"names":["ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","start","node","push","end","pop","length","chars","text","replace","advance","n","substring","parseStartTag","match","tagName","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","i","obj","split","forEach","item","key","JSON","stringify","slice","defaultTagRE","gen","codegen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","child","ast","code","compileToFunction","template","console","log","render","Function","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","method","args","result","call","inserted","ob","__ob__","observeArray","dep","notify","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","observe","dependArray","current","depend","childOb","get","set","newValue","Watcher","vm","fn","options","renderWatcher","getter","deps","depsId","Set","lazy","dirty","undefined","has","add","addSub","queueWatcher","queue","pending","flushSchedulerQueue","flushQueue","q","run","nextTick","callbacks","waiting","flushCallbacks","cbs","cb","Promise","resolve","then","initState","opts","$options","initData","computed","initComputed","proxy","_data","watchers","_computedWatchers","userDef","defineComputed","ket","setter","createComputedGetter","initStateMixin","Vue","$nextTick","createTextVNode","vnode","createElementVNode","isSameVNode","vnode1","vnode2","createElm","el","document","createElement","patchProps","appendChild","createTextNode","oldProps","props","oldStyles","style","newStyles","removeAttribute","styleName","setAttribute","patch","oldVNode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","patchVNode","replaceChild","textContent","oldChildren","newChildren","updateChildren","mountChildren","innerHTML","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","makeIndexByKey","moveIndex","moveVnode","childEl","anchor","initLifeCycle","_update","$el","_v","arguments","_c","_s","val","_render","mountComponent","updatedComponent","initMixin","_init","$mount","querySelector","ops","outerHTML","render1","vm1","prevVNode","body","render2","vm2","nextVNode","setTimeout"],"mappings":"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"}